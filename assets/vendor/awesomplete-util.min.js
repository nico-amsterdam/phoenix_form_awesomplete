// AwesompleteUtil - Nico Hoogervorst - MIT license
var AwesompleteUtil=function(){var t="awesomplete-",n=t+"loadcomplete",e=t+"close",r=t+"match",u=t+"prepop",i=t+"select",o="awe-found",a="awe-not-found",c=Awesomplete.$;function f(t,n,e){return c.fire(t,n,{detail:e})}function l(t,n){var e,i,c,l,s,d,p=t.input,m=p.classList,v=t.utilprops,h=v.selected,y=v.convertInput.call(t,p.value),b=t.opened,w=[],A=t._list;if(v.prepop=!1,A){for(l=0;l<A.length;l++)if(c=A[l],s=t.data(c,y),d=void 0,e={label:(d=Array.isArray(s)?{label:s[0],value:s[1]}:"object"==typeof s&&"label"in s&&"value"in s?s:{label:s,value:s}).label||d.value,value:d.value},0===t.maxItems&&(e.toString=function(){return""+this.label},t.filter(e,y)&&(b=!0)),i={input:{value:""}},t.replace.call(i,e),v.convertInput.call(t,i.input.value)===y){if(h&&h.value===e.value&&h.label===e.label){w=[c];break}w.push(c)}v.prevSelected!==w&&(w.length>0?n?f(p,u,w):v.changed&&(v.prevSelected=w,m.remove(a),m.add(o),f(p,r,w)):n?f(p,u,[]):v.changed&&(v.prevSelected=[],m.remove(o),b&&p===document.activeElement?m.remove(a):""!==y&&(m.add(a),f(p,r,[]))))}}function s(t){var r=this;t.type!==e&&t.type!==n&&"blur"!==t.type||t.target!==r.input||l(r,r.utilprops.prepop&&t.type===n)}function d(t){t.target===this.input&&9===t.keyCode&&this.select()}function p(t){var n=this;clearTimeout(n.utilprops.timeoutID),n.utilprops.changed=!0,n.utilprops.selected=t.text}function m(t,n,e){var r=t.utilprops;return!r.t||!r.loadall&&0===n.lastIndexOf(e,0)&&(0!==n.lastIndexOf(r.t,0)||"number"==typeof r.limit&&t._list.length>=r.limit)}function v(t,e,r){t.list=e,t.utilprops.t=r,f(t.input,n,r)}function h(){var t,n,e=this,r=e.u,u=e.i,i=e.queryVal,o=r.utilprops.val;if(200===u.status){if(t=JSON.parse(u.responseText),r.utilprops.convertResponse&&(t=r.utilprops.convertResponse(t)),!Array.isArray(t))if(0===r.utilprops.limit||1===r.utilprops.limit)t=function(t){return 0===Object.keys(t).length&&t.constructor===Object}(t)?[]:[t];else for(n in t)if(Array.isArray(t[n])){t=t[n];break}Array.isArray(t)&&m(r,o,i)&&v(r,t,i||r.utilprops.loadall)}}function y(t,n){var e=new XMLHttpRequest;t.utilprops.ajax.call(t,t.utilprops.url,t.utilprops.urlEnd,t.utilprops.loadall?"":n,h.bind({u:t,i:e,queryVal:n}),e)}function b(t,n,e){t.utilprops.url&&m(t,n,n)?"number"==typeof e&&e>0?t.utilprops.timeoutID=setTimeout(y.bind(null,t,n),e):y(t,n):l(t,t.utilprops.prepop)}function w(t,n,e){return t.utilprops.prepop=e||!1,t.utilprops.val!==n&&(clearTimeout(t.utilprops.timeoutID),t.utilprops.selected=null,t.utilprops.changed=!0,t.utilprops.val=n,(""===n||n.length<t.minChars)&&function(t){var n=t.input,e=n.classList;e.remove(a),e.remove(o),f(n,r,[])}(t),n.length>=t.minChars&&b(t,n,t.utilprops.debounce)),t}function A(t){var n,e=this;t.target===e.input&&(n=e.utilprops.convertInput.call(e,e.input.value),w(e,n))}function k(t){return c.create("li",{innerHTML:t,role:"option","aria-selected":"false"})}function C(t){var n,e,r=this,u=r.o,i=r.l,o=r.p;t.target===c(u)&&("function"==typeof o?o(t,i):(n=c(o))&&n!==document.activeElement&&(e=Array.isArray(t.detail)&&1===t.detail.length?t.detail[0]:null,e=(i&&e?e[i]:e)||"",void 0!==n.value?(n.value=e,n.classList&&n.classList.remove&&n.classList.remove(a)):void 0!==n.src?n.src=e:n.innerHTML=e))}function F(t){var n,e;t.target===c(this.btnId)&&(t.preventDefault(),0===(n=this.u).ul.childNodes.length||n.ul.hasAttribute("hidden")?(e=n.minChars,n.minChars=0,n.evaluate(),n.minChars=e):n.close())}function j(t,n,e){var r=c.regExpEscape(function(t){return t.replace("&","&amp;").replace("<","&lt;").replace(">","&gt;")}(n).trim()),u=""===r?null:e?RegExp("^"+r,"i"):RegExp("(?!<[^>]+?>)"+r+"(?![^<]*?>)","gi");return t.replace(u,"<mark>$&</mark>")}function O(t,n,e,r,u){var i,o=u.root,a=u.value,c=u.label||u.value,f=!0,l=[];if(0===r&&o&&e&&0!==(e+".").lastIndexOf(o+".",0)&&0!==(o+".").lastIndexOf(e+".",0))return t;if(Object(n)!==n)e?t[e]=n:t=n;else if(Array.isArray(n)){for(i=0;i<n.length;i++)l.push(O({},n[i],"",r+1,u));e?t[e]=l:t=l}else{for(i in n)f=!1,O(t,n[i],e?e+"."+i:i,r,u);f&&e&&(t[e]={})}return r<2&&e&&(a&&0===(e+".").lastIndexOf(a+".",0)&&(t.value=t[e]),c&&0===(e+".").lastIndexOf(c+".",0)&&(t.label=t[e])),0===r&&(a&&!("value"in t)&&(t.value=null),c&&!("label"in t)&&(t.label=null)),t}function g(){var t=this,r=t.u.input,u=t.m,o=t.v,a=t.h,c=t.A;r.removeEventListener(i,c),r.removeEventListener(n,u),r.removeEventListener(e,u),r.removeEventListener("blur",u),r.removeEventListener("input",o),r.removeEventListener("keydown",a)}return{ajax:function(t,n,e,r,u){var i=encodeURIComponent(e);return(u=u||new XMLHttpRequest).open("GET",t+("function"==typeof n?n(i):i+(n||""))),u.onload=r,u.send(),u},convertInput:function(t){return"string"==typeof t?t.trim().toLowerCase():""},item:k,load:v,mark:j,itemContains:function(t,n,e){var r;return""!==n.trim()&&((r=(""+t).split(/<p>/))[0]=j(r[0],n),t=r.join("<p>")),k(t)},itemMarkAll:function(t,n,e){return k(""===n.trim()?""+t:j(""+t,n))},itemStartsWith:function(t,n,e){return k(""===n.trim()?""+t:j(""+t,n,!0))},itemWords:function(t,n,e){var r,u,i=n.split(/\s+/);if(""!==n.trim()){for(r=(""+t).split("<"),u=0;u<i.length;u++)r[0]=j(r[0],i[u]);t=r.join("<")}return k(t)},create:function(t,n,e){e.item=e.item||this.itemContains;var r=new Awesomplete(t,e);return r.utilprops=n||{},r.utilprops.url||void 0!==r.utilprops.loadall||(r.utilprops.loadall=!0),r.utilprops.ajax=r.utilprops.ajax||this.ajax,r.utilprops.convertInput=r.utilprops.convertInput||this.convertInput,r},attach:function(t){var r=t.input,u=s.bind(t),o=d.bind(t),a=A.bind(t),f=p.bind(t),l=g.bind({u:t,m:u,v:a,h:o,A:f}),m={keydown:o,input:a};return m.blur=m[e]=m[n]=u,m[i]=f,c.bind(r,m),t.utilprops.detach=l,t.utilprops.prepop&&(t.utilprops.loadall||""!==r.value)&&(t.utilprops.val=t.utilprops.convertInput.call(t,r.value),b(t,t.utilprops.val)),t},update:function(t,n,e){return t.input.value=n,w(t,n,e)},start:function(t,n,e){return this.attach(this.create(t,n,e))},detach:function(t){return clearTimeout(t.utilprops.timeoutID),t.utilprops.detach&&(t.utilprops.detach(),delete t.utilprops.detach),t},createCopyFun:function(t,n,e){return C.bind({o:t,l:n,p:c(e)||e})},attachCopyFun:function(t,n,e){return n="boolean"!=typeof n||n,(e=e||document.body).addEventListener(r,t),n&&e.addEventListener(u,t),t},startCopy:function(t,n,e,r){var u=c(t);return this.attachCopyFun(this.createCopyFun(u||t,n,e),r,u)},detachCopyFun:function(t,n){return(n=n||document.body).removeEventListener(u,t),n.removeEventListener(r,t),t},createClickFun:function(t,n){return F.bind({btnId:t,u:n})},attachClickFun:function(t,n){return(n=n||document.body).addEventListener("click",t),t},startClick:function(t,n){var e=c(t);return this.attachClickFun(this.createClickFun(e||t,n),e)},detachClickFun:function(t,n){return(n=n||document.body).removeEventListener("click",t),t},filterContains:function(t,n){return Awesomplete.FILTER_CONTAINS(t.value,n)},filterStartsWith:function(t,n){return Awesomplete.FILTER_STARTSWITH(t.value,n)},filterOff:function(t,n){return!0},filterWords:function(t,n){var e,r=n.split(/\s+/),u=!0;for(t=" "+t,e=0;u&&e<r.length;e++)u=Awesomplete.FILTER_CONTAINS(t," "+r[e]);return u},jsonFlatten:function(t){return O({},t,"",0,this)}}}();"object"==typeof module&&module.exports&&(module.exports=AwesompleteUtil),"undefined"!=typeof self&&(self.AwesompleteUtil=AwesompleteUtil);
//# sourceMappingURL=awesomplete-util.min.js.map